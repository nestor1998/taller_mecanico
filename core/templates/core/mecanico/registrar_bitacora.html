{% extends "core/base.html" %}
{% block content %}

<nav aria-label="breadcrumb" class="mb-3">
    <ol class="breadcrumb">
        <li class="breadcrumb-item"><a href="{% url 'dashboard' %}">Dashboard</a></li>
        <li class="breadcrumb-item"><a href="{% url 'mis_trabajos' %}">Mis Trabajos</a></li>
        <li class="breadcrumb-item active">Registrar Bitácora</li>
    </ol>
</nav>

<h3>Bitácora - OT #{{ ot.id }}</h3>
<p class="text-muted">Vehículo: {{ ot.vehiculo.patente }} - {{ ot.vehiculo.marca }} {{ ot.vehiculo.modelo }}</p>

{% if form.errors %}
    <div class="alert alert-danger">
        <strong>Errores en el formulario:</strong>
        {{ form.errors }}
    </div>
{% endif %}

<form method="POST" enctype="multipart/form-data">
    {% csrf_token %}

    <div class="mb-3">
        <label for="{{ form.descripcion.id_for_label }}" class="form-label">{{ form.descripcion.label }}</label>
        {{ form.descripcion }}
        {% if form.descripcion.errors %}
            <div class="text-danger small">{{ form.descripcion.errors }}</div>
        {% endif %}
    </div>

    <div class="mb-3">
        <label for="{{ form.tiempo_ejecucion_minutos.id_for_label }}" class="form-label">{{ form.tiempo_ejecucion_minutos.label }}</label>
        {{ form.tiempo_ejecucion_minutos }}
        {% if form.tiempo_ejecucion_minutos.errors %}
            <div class="text-danger small">{{ form.tiempo_ejecucion_minutos.errors }}</div>
        {% endif %}
    </div>

    <div class="mb-3">
        <label for="{{ form.estado_avance.id_for_label }}" class="form-label">{{ form.estado_avance.label }}</label>
        {{ form.estado_avance }}
        {% if form.estado_avance.errors %}
            <div class="text-danger small">{{ form.estado_avance.errors }}</div>
        {% endif %}
    </div>

    <div class="mb-3">
        <label for="id_imagenes" class="form-label">Fotos (opcional, múltiples)</label>
        <input type="file" name="imagenes" id="id_imagenes" multiple class="form-control" accept="image/*">
        <small class="form-text text-muted">Puedes seleccionar múltiples imágenes</small>
    </div>

    <hr>

    <h5>Solicitud de Cambio (opcional)</h5>
    <div class="mb-3">
        {{ form.solicitud_cambio }}
        {% if form.solicitud_cambio.errors %}
            <div class="text-danger small">{{ form.solicitud_cambio.errors }}</div>
        {% endif %}
    </div>

    <button type="submit" class="btn btn-success">Guardar Bitácora</button>
    <a href="{% url 'mis_trabajos' %}" class="btn btn-secondary">Cancelar</a>
</form>

{% endblock %}
